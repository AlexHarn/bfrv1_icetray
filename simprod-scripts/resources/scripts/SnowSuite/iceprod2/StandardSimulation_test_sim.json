{
  "difplus":null,
  "tasks":[
    {
      "requirements":{
        "gpu":1,
        "disk":15,
        "cpu":2,
        "memory":3
      },
      "name":"hits",
      "parameters":{},
      "depends":[],
      "batchsys":null,
      "resources":[],
      "projects":[],
      "classes":[],
      "data":[],
      "trays":[
        {
          "name":"nugen",
          "parameters":{},
          "modules":[
            {
              "src":"",
              "resources":[],
              "name":"",
              "env_clear":true,
              "args":{
                "mjd":"$(mjd_15)",
                "PropagateMuons":true,
                "NuFlavor":"$steering(NUGEN::flavor)",
                "FromEnergy":"$steering(NUGEN::emin)",
                "CrossSections":"csms",
                "ToEnergy":"$steering(NUGEN::emax)",
                "EnableHistogram":false,
                "CrossSectionsPath":"/cvmfs/icecube.opensciencegrid.org/data/neutrino-generator/cross_section_data/",
                "summaryfile":"summary.json",
                "nevents":"$steering(nevents)",
                "outputfile":"nugen.i3.zst",
                "HistogramFilename":"histo.pkl",
                "nproc":"$(jobs_submitted)",
                "gcdfile":"$(gcdfile_pass2)",
                "seed":"$steering(seed)",
                "gamma":"$steering(NUGEN::gamma)",
                "procnum":"$(job)",
		"UseGSLRNG": true
              },
              "env_shell": "$steering(software)/src/simprod-scripts/resources/scripts/SnowSuite/iceprod2/load_env $steering(env_path)/setup.sh $steering(software)/build/env-shell.sh",
              "classes":[],
              "running_class":"icecube.simprod.modules.nugen.NuGen",
              "parameters":{},
              "data":[],
              "projects":[]
            }
          ],
          "classes":[],
          "resources":[],
          "iterations":1,
          "data":[],
          "projects":[]
        },
        {
          "name":"propagate",
          "parameters":{},
          "modules":[
            {
              "src":"",
              "name":"clsim",
              "env_clear":true,
              "args":{
                "runmphitfilter":true,
                "PropagateMuons":false,
                "outputfile":"signalhits.i3.zst",
                "IceModel":"$steering(IceModel)",
                "oversize":1,
                "efficiency":"$steering(DOMefficiency)",
                "UseGPUs":"$steering(UseGPU)",
                "nproc":"$(jobs_submitted)",
                "summaryfile":"summary.json",
                "seed":"$steering(seed)",
		"UseGSLRNG": true,
                "inputfilelist":[
                  "nugen.i3.zst"
                ],
		
                "IceModelLocation":"$steering(IceSimPath)/ice-models/resources/models/",
                "holeiceparametrization":"$steering(IceSimPath)/ice-models/resources/models/angsens_flasher/as.9",
                "gcdfile":"$(gcdfile_pass2)",
                "procnum":"$(job)"
              },
              "env_shell": "$steering(software)/src/simprod-scripts/resources/scripts/SnowSuite/iceprod2/load_env $steering(env_path)/setup.sh $steering(software)/build/env-shell.sh",
              "classes":[],
              "running_class":"icecube.simprod.modules.ClSim",
              "parameters":{},
              "projects":[],
              "resources":[]
            },
            {
              "src":"",
              "name":"polyplopia",
              "env_clear":true,
              "args":{
                "outputfile":"hits.i3.zst",
                "IceModel":"$steering(IceModel)",
                "oversize":1,
                "procnum":"$(job)",
                "UseGPUs":"$steering(UseGPU)",
		"UseGSLRNG": true,
                "backgroundrate":5261.85,
                "efficiency":"$steering(DOMefficiency)",
                "seed":"$steering(seed)",
                "nproc":"$(jobs_submitted)",
                "IceModelLocation":"$steering(IceSimPath)/ice-models/resources/models/",
                "holeiceparametrization":"$steering(IceSimPath)/ice-models/resources/models/angsens_flasher/as.9",
                
		"gcdfile":"$(gcdfile_pass2)",
                "UsePPC":false,
                "inputfile":"signalhits.i3.zst"
              },
              "env_shell": "$steering(software)/src/simprod-scripts/resources/scripts/SnowSuite/iceprod2/load_env $steering(env_path)/setup.sh $steering(software)/build/env-shell.sh",
              "projects":[],
              "classes":[],
              "running_class":"icecube.simprod.modules.PolyplopiaModule",
              "parameters":{},
              "data":[
                {
                  "remote": "$steering(TARGET::PHOTONS)/$steering(outfile).i3.zst",
                  "local":"hits.i3.zst",
                  "type":"job_temp",
                  "compression":false,
                  "movement":"output"
                }

              ],
              "resources":[]
            }
          ],
          "classes":[],
          "projects":[],
          "iterations":1,
          "data":[],
          "resources":[]
        }
      ]
    },
    {
      "requirements":{
        "memory":3
      },
      "name":"detector",
      "parameters":{},
      "depends":[
        "hits"
      ],
      "batchsys":null,
      "resources":[],
      "projects":[],
      "classes":[],
      "data":[],
      "trays":[
        {
          "name":"ic86",
          "parameters":{},
          "modules":[
            {
              "src":"",
              "name":"",
              "env_clear":true,
              "args":{
                "outputfile":"$steering(outfile).i3.zst",
                "ProcNum":"$(job)",
                "MCType":"$steering(mctype)",
                "UseLinearTree":true,
		"UseGSLRNG": true,
                "SkipKeys":[
                  "SignalI3MCPEs",
                  "BackgroundI3MCPESeriesMap",
                  "BackgroundI3MCTree",
                  "I3MCPESeriesMap",
                  "I3MCPESeriesMapWithoutNoise",
                  "I3MCTree",
                  "I3MCTree_preSampling"
                ],
                "MCPrescale":"$steering(MCPrescale)",
                "EnableHistogram":false,
                "LowMem":true,
                "HistogramFilename":"histo.pkl",
                "RunID":"$(dataset)",
                "NProc":"$(jobs_submitted)",
                "gcdfile":"$(gcdfile_pass2)",
                "seed":"$steering(seed)",
                "inputfile":"hits.i3.zst"
              },
              "env_shell": "$steering(software)/src/simprod-scripts/resources/scripts/SnowSuite/iceprod2/load_env $steering(env_path)/setup.sh $steering(software)/build/env-shell.sh",
              "projects":[],
              "classes":[],
              "running_class":"icecube.simprod.modules.IceCube",
              "parameters":{},
              "data":[
                {
                  "remote":"",
                  "local":"hits.i3.zst",
                  "type":"job_temp",
                  "compression":false,
                  "movement":"input"
                },
                {
                  "remote":"$steering(TARGET::GEN)/$steering(outfile).i3.zst",
                  "local":"$steering(outfile).i3.zst",
                  "type":"permanent",
                  "compression":false,
                  "movement":"output"
                },
                {
                  "remote":"$steering(TARGET::GEN)/histos/detector_$(job).pkl",
                  "compression":false,
                  "transfer":"exists",
                  "type":"permanent",
                  "local":"histo.pkl",
                  "movement":"output"
                }
              ],
              "resources":[]
            }
          ],
          "classes":[],
          "projects":[],
          "iterations":1,
          "data":[],
          "resources":[]
        }
      ]
    },
    {
      "requirements":{
        "memory":3
      },
      "name":"filtering",
      "parameters":{},
      "depends":[
        "detector"
      ],
      "batchsys":null,
      "resources":[],
      "projects":[],
      "classes":[],
      "data":[],
      "trays":[
        {
          "name":"pass2L1",
          "parameters":{},
          "modules":[
            {
              "src":"$steering(software)/src/filterscripts/resources/scripts/SimulationFiltering.py",
              "name":"",
              "env_clear":true,
              "args":{
                "input":"$steering(outfile).i3.zst",
                "photonicsdir":"/cvmfs/icecube.opensciencegrid.org/data/photon-tables",
                "output":"l1_pass2.i3.gz",
                "gcd":"$(gcdfile_pass2)",
                "MinBiasPrescale":500
              },
              "env_shell": "$steering(software)/src/simprod-scripts/resources/scripts/SnowSuite/iceprod2/load_env $steering(env_path)/setup.sh $steering(software)/build/env-shell.sh",
              "projects":[],
              "classes":[],
              "running_class":"",
              "parameters":{},
              "data":[
                {
                  "remote":"$steering(TARGET::GEN)/$steering(outfile).i3.zst",
                  "local":"$steering(outfile).i3.zst",
                  "type":"permanent",
                  "compression":false,
                  "movement":"input"
                }
              ],
              "resources":[]
            }
          ],
          "classes":[],
          "projects":[],
          "iterations":1,
          "data":[],
          "resources":[]
        },
        {
          "name":"L2_Pass2",
          "parameters":{},
          "modules":[
            {
              "src":"$steering(software)/src/filterscripts/resources/scripts/offlineL2/process.py",
              "name":"",
              "env_clear":true,
              "args":{
                "input":"l1_pass2.i3.gz",
                "photonicsdir":"/cvmfs/icecube.opensciencegrid.org/data/photon-tables",
                "simulation":null,
                "gcd":"$(gcdfile_pass2)",
                "output":"Level2_$steering(outfile).i3.zst"
              },
              "env_shell": "$steering(software)/src/simprod-scripts/resources/scripts/SnowSuite/iceprod2/load_env $steering(env_path)/setup.sh $steering(software)/build/env-shell.sh",
              "projects":[],
              "classes":[],
              "running_class":"",
              "parameters":{},
              "data":[
                {
                  "remote":"$steering(TARGET::LEVEL2)/Level2_$steering(outfile).i3.zst",
                  "local":"Level2_$steering(outfile).i3.zst",
                  "type":"permanent",
                  "compression":false,
                  "movement":"output"
                }
              ],
              "resources":[]
            }
          ],
          "classes":[],
          "projects":[],
          "iterations":1,
          "data":[],
          "resources":[]
        }
      ]
    }
  ],
  "description":"Std. Simulation, NuGen NuMu. All based on the same metaproject (combo.snobo). Made for comparison of SnowStormGlobalFit simulations, DO NOT USE FOR ANALYSIS.",
  "dataset":9999,
  "version":1,
  "steering":{
    "batchsys":null,
    "data":[],
    "system":{},
    "parameters":{
      "weighted":"weighted",
      "mctype":"nugen_numu",
      "gcdfile_pass2":"/cvmfs/icecube.opensciencegrid.org/data/GCD/GeoCalibDetectorStatus_IC86.All_Pass2.i3.gz",
      "ScriptsURL":"http://prod-exe.icecube.wisc.edu/svn/projects/filterscripts/releases/V17-04-01/resources/scripts/",
      "seed":"$(dataset)",
      "UseGPU":false,
      "category":"neutrino-generator",
      "subdirectory":"$sprintf('%07d-%07d',$eval($(job)//1000*1000),$eval($(job)//1000*1000+999))",
      "outfile_base":"$sprintf('%s_%s.%06d.%06d',$steering(geometry),$steering(mctype),$(dataset),$(job))",
      "RunID":"$eval($eval($(dataset)*100000 + $(job)) % 100000000 + 1)",
      "NUGEN::flavor":"NuMu",
      "NUGEN::emin":"1e2",
      "NUGEN::emax":"1e8",
      "NUGEN::gamma":2,
      "NUGEN::zenithmin":0,
      "NUGEN::zenithmax":180,
      "IceModel":"spice_3.2.1",
      "DOMefficiency":1,
      "MCPrescale":1,
      "outfile":"$sprintf('%s_%s.%06d.%06d',$steering(geometry),$steering(NUGEN::flavor),$(dataset),$(job))",
      "geometry":"IC86.2016",
      
      "TARGET::LEVEL2": "gsiftp://gridftp.icecube.wisc.edui/data/sim/IceCube/2019/filtered/level2/snowstorm/$(dataset)/$(subdirectory)/",
      "TARGET::GEN": "gsiftp://gridftp.icecube.wisc.edu/data/sim/IceCube/2019/generated/snowstorm/$(category)/$(dataset)/$(subdirectory)/",
      "TARGET::PHOTONS": "gsiftp://gridftp.icecube.wisc.edu/data/sim/IceCube/2019/generated/snowstorm/photon_propagation/$/dataset)/$(subdirectory)/",
 
      "IceSimPath":"$steering(software)/build/",
      "software": "/cvmfs/icecube.opensciencegrid.org/users/eganster/combo.branches.snobo.py3-v4.0.1.RHEL_7_x86_64/",
      "env_path": "/cvmfs/icecube.opensciencegrid.org/py3-v4.0.1",
      "nevents":10
    },
    "resources":[]
  },
  "options":{},
  "categories":[]
}
